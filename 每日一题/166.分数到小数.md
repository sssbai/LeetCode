## [166. 分数到小数](https://leetcode.cn/problems/fraction-to-recurring-decimal/)

从结果的字符串来找循环部分十分不容易，但是换个角度，既然有循环的部分，那么某个中间量是否也在循环呢？

第一次思考的时候采用的是当前字符是否循环，但是会存在问题，就是字符的循环无法代表当前小数是无限循环小数。

因此可以考虑被除数是否无限循环，用哈希的方式啦计算。

```python
class Solution:
    def fractionToDecimal(self, numerator: int, denominator: int) -> str:
        a, b = numerator, denominator
        sign = "" if a * b >= 0 else "-"
        a, b = abs(a), abs(b)
        q, r = a // b, a % b
        if r == 0: return sign + str(q)
        ans = sign + str(q) + "."
        umap = {}
        while r:
            umap[r] = len(ans)
            r *= 10
            q, r = r // b, r % b
            ans += str(q)
            if r in umap:
                pos = umap[r]
                return ans[:pos] + "(" + ans[pos:] + ")"
        return ans
            


```

```c++
class Solution {
public:
    string fractionToDecimal(int numerator, int denominator) {
        long long a = numerator, b = denominator;
        string sign = a * b >= 0 ? "": "-";
        a = abs(a);
        b = abs(b);
        long long q = a / b;
        long long r = a % b;
        if(r == 0){
            return sign + to_string(q);
        }
        string res = sign + to_string(q) + ".";
        unordered_map<long long, int> umap;
        while(r){
            umap[r] = res.size();
            r *= 10;
            q = r / b;
            r = r % b;
            res += '0' + q; 
            if(umap.contains(r)){
                int pos = umap[r];
                return res.substr(0, pos) + "(" + res.substr(pos) + ")";
            }
        }
        return res;
    }
};
```

